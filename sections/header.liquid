<header class="bb-header relative z-[5] border-b-[.0625rem] border-solid border-[#eee]">
  <div class="bottom-header py-[1.25rem] max-[61.9375rem]:py-[.9375rem]">
    <div class="flex flex-wrap justify-between relative items-center mx-auto min-[87.5rem]:max-w-[82.5rem] min-[75rem]:max-w-[71.25rem] min-[62rem]:max-w-[60rem] min-[48rem]:max-w-[45rem] min-[36rem]:max-w-[33.75rem]">
      <div class="flex flex-wrap w-full">
        <div class="w-full px-[.75rem]">
          <div class="inner-bottom-header flex justify-between max-[47.9375rem]:flex-col">
            <div class="cols bb-logo-detail flex max-[47.9375rem]:justify-between">
              <!-- Header Logo Start -->
              <div class="header-logo flex items-center max-[35.9375rem]:justify-center">
                <a href="{{ routes.root_url }}">
                  {% if settings.logo_image != blank %}
                    <img
                      src="{{ settings.logo_image | img_url: 'original' }}"
                      alt="logo"
                      class="light w-[7.8125rem] max-[61.9375rem]:w-[7.1875rem] block"
                    >
                  {% else %}
                    <h2>{{ shop.name }}</h2>
                  {% endif %}
                </a>
              </div>
              <!-- Header Logo End -->
              <!-- Mobile Category Toggle -->
              <a
                href="javascript:void(0)"
                class="bb-sidebar-toggle bb-category-toggle hidden max-[61.9375rem]:flex max-[61.9375rem]:items-center max-[61.9375rem]:ml-[1.25rem] max-[61.9375rem]:border-[.0625rem] max-[61.9375rem]:border-solid max-[61.9375rem]:border-[#eee] max-[61.9375rem]:w-[2.5rem] max-[61.9375rem]:h-[2.5rem] max-[61.9375rem]:rounded-[.9375rem] justify-center transition-all duration-[0.3s] ease-in-out font-Poppins text-[.9375rem] text-[#686e7d] font-light leading-[1.75rem] tracking-[.48px]"
                id="bb-mobile-menu-toggle"
              >
                <svg
                  class="svg-icon h-[1.875rem] w-[1.875rem] max-[61.9375rem]:w-[1.375rem] max-[61.9375rem]:h-[1.375rem]"
                  viewBox="0 0 1024 1024"
                  version="1.1"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path class="fill-[#6c7fd8]" d="M384 928H192a96 96 0 0 1-96-96V640a96 96 0 0 1 96-96h192a96 96 0 0 1 96 96v192a96 96 0 0 1-96 96zM192 608a32 32 0 0 0-32 32v192a32 32 0 0 0 32 32h192a32 32 0 0 0 32-32V640a32 32 0 0 0-32-32H192zM784 928H640a96 96 0 0 1-96-96V640a96 96 0 0 1 96-96h192a96 96 0 0 1 96 96v144a32 32 0 0 1-64 0V640a32 32 0 0 0-32-32H640a32 32 0 0 0-32 32v192a32 32 0 0 0 32 32h144a32 32 0 0 1 0 64zM384 480H192a96 96 0 0 1-96-96V192a96 96 0 0 1 96-96h192a96 96 0 0 1 96 96v192a96 96 0 0 1-96 96zM192 160a32 32 0 0 0-32 32v192a32 32 0 0 0 32 32h192a32 32 0 0 0 32-32V192a32 32 0 0 0-32-32H192zM832 480H640a96 96 0 0 1-96-96V192a96 96 0 0 1 96-96h192a96 96 0 0 1 96 96v192a96 96 0 0 1-96 96zM640 160a32 32 0 0 0-32 32v192a32 32 0 0 0 32 32h192a32 32 0 0 0 32-32V192a32 32 0 0 0-32-32H640z" />
                </svg>
              </a>
            </div>
            <div class="cols flex justify-center">
              <!-- Search Bar (unchanged) -->
              ...
            </div>
            <div class="cols bb-icons flex justify-center">
              <div class="bb-flex-justify max-[35.9375rem]:flex max-[35.9375rem]:justify-between">
                <div class="bb-header-buttons h-full flex justify-end items-center">
                  <!-- Account -->
                  <div class="bb-acc-drop relative">
                    <a
                      href="{% if customer %}{{ routes.account_url }}{% else %}{{ routes.account_login_url }}{% endif %}"
                      class="bb-header-btn bb-header-user dropdown-toggle bb-user-toggle transition-all duration-[0.3s] ease-in-out relative flex w-[auto] items-center whitespace-nowrap ml-[1.875rem] max-[74.9375rem]:ml-[1.25rem] max-[47.9375rem]:ml-[0]"
                      title="Account"
                    >
                      <div class="header-icon relative flex">
                        <!-- SVG icon -->
                      </div>
                      <div class="bb-btn-desc flex flex-col ml-[.625rem] max-[74.9375rem]:hidden">
                        <span class="bb-btn-title ...">Account</span>
                        <span class="bb-btn-stitle ...">
                          {%- if customer %}{{ customer.first_name }}{% else %}Login{% endif -%}
                        </span>
                      </div>
                    </a>
                    {% unless customer %}
                      <ul class="bb-dropdown-menu ...">
                        <li><a class="dropdown-item ..." href="{{ routes.account_register_url }}">Register</a></li>
                        <li><a class="dropdown-item ..." href="{{ routes.account_login_url }}">Login</a></li>
                      </ul>
                    {% endunless %}
                  </div>
                  <!-- Wishlist -->
                  <a href="/pages/wishlist" class="bb-header-btn bb-wish-toggle ...">
                    <div class="header-icon relative flex">
                      <!-- SVG icon -->
                    </div>
                    <div class="bb-btn-desc ...">
                      <span class="bb-btn-title ..."
                        ><b class="bb-wishlist-count">
                          {%- if customer %}{{ customer.tags.size }}{% else %}0{% endif -%}
                        </b>
                        items</span
                      >
                      <span class="bb-btn-stitle ...">Wishlist</span>
                    </div>
                  </a>
                  <!-- Cart -->
                  <a href="{{ routes.cart_url }}" class="bb-header-btn bb-cart-toggle ...">
                    <div class="header-icon relative flex">
                      <!-- SVG icon -->
                    </div>
                    <div class="bb-btn-desc ...">
                      <span class="bb-btn-title ..."
                        ><b class="bb-cart-count">{{ cart.item_count }}</b> items</span
                      >
                      <span class="bb-btn-stitle ...">Cart</span>
                    </div>
                  </a>
                  <!-- Mobile menu toggle -->
                  <a
                    href="javascript:void(0)"
                    class="bb-toggle-menu hidden max-[61.9375rem]:flex max-[61.9375rem]:ml-[1.25rem]"
                    id="bb-mobile-menu-open"
                  >
                    <div class="header-icon">
                      <i class="ri-menu-3-fill text-[1.375rem] text-[#6c7fd8]"></i>
                    </div>
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Desktop Menu -->
  <div class="bb-main-menu-desk bg-[#fff] py-[.3125rem] border-t-[.0625rem] border-solid border-[#eee] max-[61.9375rem]:hidden">
    <div class="flex flex-wrap justify-between relative items-center mx-auto ...">
      <div class="flex flex-wrap w-full">
        <div class="w-full px-[.75rem]">
          <div class="bb-inner-menu-desk flex ...">
            <!-- Category Toggle Button (unchanged) -->
            ...
            <!-- Dynamic Main Menu -->
            <nav
              class="bb-main-menu relative flex flex-[auto] justify-start max-[61.9375rem]:hidden"
              id="navbarSupportedContent"
            >
              <ul class="navbar-nav flex flex-wrap flex-row">
                {% for link in section.settings.menu.links %}
                  <li class="nav-item bb-dropdown flex items-center relative mr-[2.8125rem] group">
                    {% if link.links != blank %}
                      <div class="relative group">
                        <a href="{{ link.url }}" class="flex items-center gap-x-1 ...">
                          {{ link.title }}
                          <svg ...>
                            ...
                          </svg>
                        </a>
                        <div class="absolute left-0 top-full ...">
                          <ul class="py-2">
                            {% for child_link in link.links %}
                              <li class="relative group">
                                {% if child_link.links != blank %}
                                  <div class="submenu-parent group">
                                    <a href="{{ child_link.url }}" class="px-5 font-semibold py-3 ...">
                                      {{ child_link.title }}
                                      <svg ...>
                                        ...
                                      </svg>
                                    </a>
                                    <div class="absolute left-full top-0 ...">
                                      <ul class="py-2">
                                        {% for grandchild_link in child_link.links %}
                                          <li>
                                            <a
                                              href="{{ grandchild_link.url }}"
                                              class="block px-5 font-semibold py-3 ..."
                                            >
                                              {{ grandchild_link.title }}
                                            </a>
                                          </li>
                                        {% endfor %}
                                      </ul>
                                    </div>
                                  </div>
                                {% else %}
                                  <a href="{{ child_link.url }}" class="block px-5 font-semibold py-3 ...">
                                    {{ child_link.title }}
                                  </a>
                                {% endif %}
                              </li>
                            {% endfor %}
                          </ul>
                        </div>
                      </div>
                    {% else %}
                      <a class="nav-link bb-dropdown-item ..." href="{{ link.url }}">
                        {{ link.title }}
                      </a>
                    {% endif %}
                  </li>
                {% else %}
                  <div class="flex items-center justify-center w-full">
                    <div class="bg-[#f7f8fa] text-center shadow-sm">
                      <h2 class="text-[#6c7fd8] text-xl font-semibold mb-2">No Menu Selected</h2>
                    </div>
                  </div>
                {% endfor %}
              </ul>
            </nav>
            <!-- Location Dropdown (unchanged) -->
            ...
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Mobile Menu Overlay -->
  <div
    class="bb-mobile-menu-overlay hidden w-full h-screen fixed top-0 left-0 bg-[#000000cc] z-[16]"
    id="bb-mobile-menu-overlay"
  ></div>

  <!-- Mobile Menu -->
  <div
    id="bb-mobile-menu"
    class="bb-mobile-menu transition-all duration-[0.3s] ease-in-out w-[21.25rem] h-full pt-[.9375rem] px-[1.25rem] pb-[1.25rem] fixed top-0 left-0 bg-[#fff] translate-x-[-100%] flex flex-col z-[17] overflow-auto max-[30rem]:w-[18.75rem]"
  >
    <div class="bb-menu-title w-full pb-[.625rem] flex flex-wrap justify-between">
      <span class="menu_title font-Poppins flex items-center text-[1rem] text-[#3d4750] font-semibold leading-[1.625rem] tracking-[.32px]"
        >Menu</span
      >
      <button
        type="button"
        class="bb-close-menu relative border-0 text-[1.875rem] leading-[1] text-[#ff0000] bg-transparent"
        id="bb-mobile-menu-close"
      >
        ×
      </button>
    </div>
    <div class="bb-menu-inner">
      <div class="bb-menu-content">
        <ul>
          {% for link in section.settings.menu.links %}
            <li class="relative">
              <a
                href="{{ link.url }}"
                class="transition-all duration-[0.3s] ease-in-out mb-[.75rem] p-[.75rem] block font-Poppins capitalize text-[#686e7d] border-[.0625rem] border-solid border-[#eee] rounded-[.625rem] text-[.9375rem] font-medium leading-[1.75rem] tracking-[.48px]"
              >
                {{ link.title }}
              </a>
              {% if link.links != blank %}
                <ul class="sub-menu w-full min-w-[auto] p-0 mb-[.625rem] static hidden visible opacity-100">
                  {% for child_link in link.links %}
                    <li class="relative">
                      <a
                        href="{{ child_link.url }}"
                        class="transition-all duration-[0.3s] ease-in-out mb-0 pl-[.9375rem] pr-0 py-[.75rem] capitalize block text-[.875rem] font-normal text-[#686e7d]"
                      >
                        {{ child_link.title }}
                      </a>
                      {% if child_link.links != blank %}
                        <ul class="sub-menu w-full min-w-[auto] p-0 mb-[.625rem] static hidden visible opacity-100">
                          {% for grandchild_link in child_link.links %}
                            <li class="relative">
                              <a
                                href="{{ grandchild_link.url }}"
                                class="font-Poppins leading-[1.75rem] tracking-[.48px] transition-all duration-[0.3s] ease-in-out font-normal pl-[1.875rem] text-[.875rem] text-[#777] mb-0 capitalize block py-[.75rem]"
                              >
                                {{ grandchild_link.title }}
                              </a>
                            </li>
                          {% endfor %}
                        </ul>
                      {% endif %}
                    </li>
                  {% endfor %}
                </ul>
              {% endif %}
            </li>
          {% endfor %}
        </ul>
      </div>
      <!-- Social icons (unchanged) -->
      ...
    </div>
  </div>

  <script>
    // Mobile menu open/close
    document.getElementById('bb-mobile-menu-toggle')?.addEventListener('click', function () {
      document.getElementById('bb-mobile-menu').style.transform = 'translateX(0)';
      document.getElementById('bb-mobile-menu-overlay').classList.remove('hidden');
    });
    document.getElementById('bb-mobile-menu-open')?.addEventListener('click', function () {
      document.getElementById('bb-mobile-menu').style.transform = 'translateX(0)';
      document.getElementById('bb-mobile-menu-overlay').classList.remove('hidden');
    });
    document.getElementById('bb-mobile-menu-close')?.addEventListener('click', function () {
      document.getElementById('bb-mobile-menu').style.transform = 'translateX(-100%)';
      document.getElementById('bb-mobile-menu-overlay').classList.add('hidden');
    });
    document.getElementById('bb-mobile-menu-overlay')?.addEventListener('click', function () {
      document.getElementById('bb-mobile-menu').style.transform = 'translateX(-100%)';
      this.classList.add('hidden');
    });
  </script>
</header>

{% schema %}
{
  "name": "Header",
  "class": "header",
  "settings": [
    {
      "type": "link_list",
      "id": "menu",
      "label": "Menu"
    },
    {
      "type": "image_picker",
      "id": "logo_image",
      "label": "Logo image"
    }
  ]
}
{% endschema %}
